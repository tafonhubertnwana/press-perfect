(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4381],{8787:function(e,a,n){"use strict";var l,t=n(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}a.Z=function(e){return t.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),l||(l=t.createElement("path",{d:"M4 13h14.09l-6.79 6.79a.996.996 0 1 0 1.41 1.41l8.5-8.5c.06-.06.09-.13.13-.2.03-.04.06-.08.08-.13a.91.91 0 0 0 .08-.37c0-.03-.01-.05-.01-.07-.01-.1-.02-.21-.06-.31a.955.955 0 0 0-.22-.33L12.72 2.8c-.2-.2-.45-.29-.71-.29-.26 0-.51.1-.71.29a.996.996 0 0 0 0 1.41L18.08 11H4c-.55 0-1 .45-1 1s.45 1 1 1Z"})))}},57758:function(e,a,n){"use strict";var l,t=n(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}a.Z=function(e){return t.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),l||(l=t.createElement("path",{d:"M2.5 8.38c0 .26.1.51.29.71l8.5 8.5c.39.39 1.02.39 1.41 0l8.5-8.5a.996.996 0 1 0-1.41-1.41L12 15.46 4.2 7.67a.996.996 0 0 0-1.41 0c-.19.2-.29.45-.29.71Z"})))}},89846:function(e,a,n){"use strict";var l,t=n(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}a.Z=function(e){return t.createElement("svg",_extends({viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e),l||(l=t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 12a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm8-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2Zm0 4a1 1 0 0 1 1 1v4h4a1 1 0 1 1 0 2h-4v4a1 1 0 1 1-2 0v-4H7a1 1 0 1 1 0-2h4V7a1 1 0 0 1 1-1Z"})))}},1656:function(e,a,n){"use strict";var l,t=n(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}a.Z=function(e){return t.createElement("svg",_extends({viewBox:"0 0 15 26",xmlns:"http://www.w3.org/2000/svg"},e),l||(l=t.createElement("path",{d:"M7.11 26C3.287 26 .178 22.757.178 18.772V5.312C.179 2.382 2.469 0 5.285 0 6.66 0 7.947.559 8.913 1.573a5.38 5.38 0 0 1 1.478 3.74v11.439c0 1.872-1.472 3.395-3.282 3.395-1.809 0-3.281-1.523-3.281-3.395V8.333a1 1 0 0 1 2 0v8.418c0 .769.575 1.394 1.281 1.394.707 0 1.282-.625 1.282-1.394V5.31c0-.894-.328-1.732-.926-2.36a2.998 2.998 0 0 0-2.18-.952c-1.713 0-3.106 1.485-3.106 3.312v13.46c0 2.882 2.212 5.228 4.93 5.228 2.72 0 4.932-2.346 4.932-5.228V8.333a1 1 0 0 1 2 0v10.439c0 3.985-3.109 7.228-6.932 7.228Z"})))}},51013:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageFileInputButton_viewer",selections:[{alias:"isMultibotEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_multibot_web"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_multibot_web")'}],type:"Viewer",abstractKey:null};l.hash="bcc8a3a9fa6469edfb78da5be21580e0",a.default=l},31168:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputAttachments_ChatMessageInputAttachment_messageAttachment",selections:[{args:null,kind:"FragmentSpread",name:"FileInfo_attachment"}],type:"MessageAttachment",abstractKey:null};l.hash="5c1de64091b0951dc9cce2f9eac236f1",a.default=l},12699:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputAttachments_ChatMessageInputAttachment_viewer",selections:[{args:null,kind:"FragmentSpread",name:"FileInfo_viewer"}],type:"Viewer",abstractKey:null};l.hash="d9c9bd2d1160ffd2047b73ad589df9bb",a.default=l},74083:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"ChatMessageInputAttachments_messageAttachments",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageInputAttachments_ChatMessageInputAttachment_messageAttachment"}],type:"MessageAttachment",abstractKey:null};l.hash="eeaee6404e1a35d10e11dfb47510ff60",a.default=l},64192:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputAttachments_viewer",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageInputAttachments_ChatMessageInputAttachment_viewer"}],type:"Viewer",abstractKey:null};l.hash="cecc4cb7b08e0fc64f11ecf14a181d25",a.default=l},5466:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputContainer_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isServerBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uploadFileSizeLimit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowsImageAttachments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"supportsFileUpload",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},{args:null,kind:"FragmentSpread",name:"ChatMessageSendButton_bot"},{args:null,kind:"FragmentSpread",name:"ChatMessageTextArea_bot"},{args:null,kind:"FragmentSpread",name:"botHelpers_useDeletion_bot"},{args:null,kind:"FragmentSpread",name:"botHelpers_useViewerHasNoMessagesLeft_bot"},{args:null,kind:"FragmentSpread",name:"subscriptionHelpers_useBotLogData_bot"},{args:null,kind:"FragmentSpread",name:"useFileUpload_bot"}],type:"Bot",abstractKey:null};l.hash="cea111d67e8462649185cfe254052738",a.default=l},60352:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputContainer_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"chatCode",storageKey:null},{args:null,kind:"FragmentSpread",name:"ChatMessageInputBotSelector_chat"},{args:null,kind:"FragmentSpread",name:"useMultibotAtMention_chat"}],type:"Chat",abstractKey:null};l.hash="ebf1fff5cf672bad39ccba4fb0575d29",a.default=l},42785:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"ChatMessageInputContainer_messageEdges",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageTextArea_messageEdges"}],type:"MessageEdge",abstractKey:null};l.hash="3763d1e0a57ccedfde9ee810abab3e3b",a.default=l},50467:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageInputContainer_viewer",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageSendButton_viewer"},{args:null,kind:"FragmentSpread",name:"ChatMessageInputAttachments_viewer"},{args:null,kind:"FragmentSpread",name:"ChatMessageTextArea_viewer"},{args:null,kind:"FragmentSpread",name:"ChatMessageFileInputButton_viewer"},{alias:"isFilePasteEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_file_paste"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_file_paste")'},{alias:"enableInputAreaForNoAccessBots",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_private_deleted_bots_changes_p2"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_private_deleted_bots_changes_p2")'}],type:"Viewer",abstractKey:null};l.hash="517fa90294a0bfc5fc64a5eed0324fde",a.default=l},73230:function(e,a,n){"use strict";var l,t,s,i,r,o;n.r(a);let u={fragment:{argumentDefinitions:l=[{defaultValue:null,kind:"LocalArgument",name:"botId"}],kind:"Fragment",metadata:null,name:"ChatMessageLimitTooltipBotRefetchQuery",selections:[{alias:null,args:t=[{kind:"Variable",name:"botId",variableName:"botId"}],concreteType:"Bot",kind:"LinkedField",name:"botById",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[s={alias:null,args:null,kind:"ScalarField",name:"balanceTooltipText",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"numRemainingMessages",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"balanceTooltipType",storageKey:null}],storageKey:null}],storageKey:null}],type:"QueryRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"ChatMessageLimitTooltipBotRefetchQuery",selections:[{alias:null,args:t,concreteType:"Bot",kind:"LinkedField",name:"botById",plural:!1,selections:[{alias:null,args:null,concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[s,i,r,o={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null},o],storageKey:null}]},params:{id:"75a11bd9f1bf79d7c57e2d6bc2decf7acf0818fd51b19bfaaaa1bd69c78c7713",metadata:{},name:"ChatMessageLimitTooltipBotRefetchQuery",operationKind:"query",text:null}};u.hash="314a0e419e698efc6a45f0db4b881fbf",a.default=u},80946:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageLimitTooltip_bot",selections:[{alias:null,args:null,concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numRemainingMessages",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipType",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null},{args:null,kind:"FragmentSpread",name:"subscriptionHelpers_useBotLogData_bot"}],type:"Bot",abstractKey:null};l.hash="74836a86dc840fab1a13c57a98d49df9",a.default=l},27738:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageLimitTooltip_viewer",selections:[{alias:null,args:null,concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isActive",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForWebSubscriptions",storageKey:null}],type:"Viewer",abstractKey:null};l.hash="73da26ccf4397272bc7e930b734266f2",a.default=l},72612:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageSendButton_bot",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageLimitTooltip_bot"}],type:"Bot",abstractKey:null};l.hash="82fbd2e64529b601ae67251cfcd5e239",a.default=l},19117:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageSendButton_viewer",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageLimitTooltip_viewer"}],type:"Viewer",abstractKey:null};l.hash="ed14f72231a4384c345c485904951c2a",a.default=l},9883:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageTextArea_bot",selections:[{args:null,kind:"FragmentSpread",name:"subscriptionHelpers_useBotLogData_bot"},{args:null,kind:"FragmentSpread",name:"botHelpers_useViewerHasNoMessagesLeft_bot"}],type:"Bot",abstractKey:null};l.hash="5e5674f17e6353a7dc2608e86d15a879",a.default=l},87330:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"ChatMessageTextArea_getLastHumanMessageText_messageEdge"};l.hash="a01c79c1084fa7fcca797236c2cf1604",a.default=l},73938:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"ChatMessageTextArea_messageEdges",selections:[{args:null,kind:"FragmentSpread",name:"ChatMessageTextArea_useOnKeyDown_messageEdges"}],type:"MessageEdge",abstractKey:null};l.hash="adef175ef9e8eb0b392205c0b7ec1e41",a.default=l},91963:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:{plural:!0},name:"ChatMessageTextArea_useOnKeyDown_messageEdges",selections:[{kind:"InlineDataFragmentSpread",name:"ChatMessageTextArea_getLastHumanMessageText_messageEdge",selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},{kind:"InlineDataFragmentSpread",name:"messageHelpers_isHumanMessage",selections:[{alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null}],args:null,argumentDefinitions:[]}],storageKey:null}],args:null,argumentDefinitions:[]}],type:"MessageEdge",abstractKey:null};l.hash="326ac8a25d146f97c1aab77fcfc8ef9b",a.default=l},97369:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ChatMessageTextArea_viewer",selections:[{alias:"isMultibotEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_multibot_web"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_multibot_web")'}],type:"Viewer",abstractKey:null};l.hash="a0aa582d2e97f70095f9b9d452bfcc71",a.default=l},38117:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"getChatContentType_chat"};l.hash="2291a2b3c3c16aec13efd467f4adefba",a.default=l},14973:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"resendMessage_bot"};l.hash="dd2b0610e4bd5a8280817ddcdd093f52",a.default=l},17048:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"resendMessage_chat"};l.hash="18d6b5bb8062a445ad9f0eb2fd4f5f1d",a.default=l},71669:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"resendMessage_message"};l.hash="e56e3fa2233e8ab03a48556a6fc0f1ec",a.default=l},53398:function(e,a,n){"use strict";var l,t,s,i,r,o,u,d,c,g,m,p,h,b,k,y,_,f,F,v,S,C,K,M,w,I,L,T,x,A,D,E,B,N,R,P,V,G,j,U,O,Z,H,z,W,$,Q,q,Y,X,J,ee,ea,en,el,et,es,ei,er,eo,eu,ed,ec,eg,em,ep,eh,eb,ek,ey,e_,ef,eF,ev,eS,eC,eK,eM,ew,eI,eL,eT,ex,eA,eD,eE,eB,eN,eR,eP;n.r(a);let eV=(l={defaultValue:null,kind:"LocalArgument",name:"attachments"},t={defaultValue:null,kind:"LocalArgument",name:"bot"},s={defaultValue:null,kind:"LocalArgument",name:"chatId"},i={defaultValue:null,kind:"LocalArgument",name:"clientNonce"},r={defaultValue:null,kind:"LocalArgument",name:"existingMessageAttachmentsIds"},o={defaultValue:null,kind:"LocalArgument",name:"messagePointsDisplayPrice"},u={defaultValue:null,kind:"LocalArgument",name:"query"},d={defaultValue:null,kind:"LocalArgument",name:"sdid"},c={defaultValue:null,kind:"LocalArgument",name:"shouldFetchChat"},g={defaultValue:null,kind:"LocalArgument",name:"source"},m=[{kind:"Variable",name:"attachments",variableName:"attachments"},{kind:"Variable",name:"bot",variableName:"bot"},{kind:"Variable",name:"chatId",variableName:"chatId"},{kind:"Variable",name:"clientNonce",variableName:"clientNonce"},{kind:"Variable",name:"existingMessageAttachmentsIds",variableName:"existingMessageAttachmentsIds"},{kind:"Variable",name:"messagePointsDisplayPrice",variableName:"messagePointsDisplayPrice"},{kind:"Variable",name:"query",variableName:"query"},{kind:"Variable",name:"sdid",variableName:"sdid"},{kind:"Variable",name:"source",variableName:"source"}],h={alias:null,args:null,kind:"ScalarField",name:"messageId",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"creationTime",storageKey:null},k={args:null,kind:"FragmentSpread",name:"ChatHistoryListItem_message"},y=[p={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],_={alias:null,args:null,kind:"ScalarField",name:"status",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},v={alias:null,args:null,concreteType:"MessageCreateFailedUrl",kind:"LinkedField",name:"failedUrls",plural:!0,selections:[F={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reason",storageKey:null}],storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"chatId",storageKey:null},C={alias:null,args:null,kind:"ScalarField",name:"chatCode",storageKey:null},K={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"hasMarkdownRendering",storageKey:null},L={kind:"InlineDataFragmentSpread",name:"optimisticMessage_createOptimisticBotMessage_bot",selections:[M={alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null},{kind:"InlineDataFragmentSpread",name:"localMessage_createLocalChatMessage_bot",selections:[p,{args:null,kind:"FragmentSpread",name:"ChatMessage_bot"},{args:null,kind:"FragmentSpread",name:"ChatLastMessageArea_bot"},{args:null,kind:"FragmentSpread",name:"ChatPageMain_targetedBot"}],args:null,argumentDefinitions:[]}],args:null,argumentDefinitions:[]},T={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"state",storageKey:null},A={alias:null,args:null,kind:"ScalarField",name:"author",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"contentType",storageKey:null},E={alias:null,args:null,kind:"ScalarField",name:"sourceType",storageKey:null},B={alias:null,args:null,kind:"ScalarField",name:"messageStateText",storageKey:null},O={alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[p,N={alias:null,args:null,kind:"ScalarField",name:"attachmentId",storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},F,{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[P={alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null},p,V={alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"isInline",storageKey:null},{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},F,{alias:null,args:null,kind:"ScalarField",name:"thumbnailUrl",storageKey:null}],storageKey:null},U={kind:"InlineFragment",selections:[j={kind:"ClientExtension",selections:[G={alias:null,args:null,kind:"ScalarField",name:"isOptimistic",storageKey:null}]}],type:"MessageAttachment",abstractKey:null}],type:"Attachment",abstractKey:"__isAttachment"},j],storageKey:null},et={alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[Z={alias:null,args:null,kind:"ScalarField",name:"messageTimeoutSecs",storageKey:null},w,H={alias:null,args:null,kind:"ScalarField",name:"allowsImageAttachments",storageKey:null},z={alias:null,args:null,kind:"ScalarField",name:"isApiBot",storageKey:null},W={alias:null,args:null,kind:"ScalarField",name:"limitedAccessType",storageKey:null},$={alias:null,args:null,kind:"ScalarField",name:"shouldHideLimitedAccessTag",storageKey:null},Q={alias:null,args:null,kind:"ScalarField",name:"translatedBotTags",storageKey:null},q={alias:null,args:null,kind:"ScalarField",name:"deletionState",storageKey:null},Y={alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},ee={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"picture",plural:!1,selections:J=[X={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isBotPicture"},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"localName",storageKey:null}],type:"LocalBotImage",abstractKey:null},{kind:"InlineFragment",selections:[F],type:"URLBotImage",abstractKey:null}],storageKey:null},ea={alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},en={alias:null,args:null,kind:"ScalarField",name:"canUserAccessBot",storageKey:null},M,p,el={kind:"TypeDiscriminator",abstractKey:"__isNode"}],storageKey:null},es={alias:null,args:null,concreteType:"CommandInfo",kind:"LinkedField",name:"command",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"commandType",storageKey:null}],storageKey:null},ei={alias:null,args:null,kind:"ScalarField",name:"vote",storageKey:null},er={alias:null,args:null,kind:"ScalarField",name:"hasCitations",storageKey:null},eo={alias:null,args:null,kind:"ScalarField",name:"textLengthOnCancellation",storageKey:null},eu={alias:null,args:null,kind:"ScalarField",name:"clientNonce",storageKey:null},ec={kind:"ClientExtension",selections:[G,ed={alias:null,args:null,kind:"ScalarField",name:"timeoutLevel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}]},eg={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},em={alias:null,args:null,kind:"ScalarField",name:"introduction",storageKey:null},eb={alias:null,args:null,concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[ep={alias:null,args:null,kind:"ScalarField",name:"numRemainingMessages",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowReminderBanner",storageKey:null},p,eh={alias:null,args:null,kind:"ScalarField",name:"displayMessagePointPrice",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"remainingMessagesLimitReason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipType",storageKey:null}],storageKey:null},ek={alias:null,args:null,kind:"ScalarField",name:"isCreatedByPoeUserAccount",storageKey:null},ey={alias:null,args:null,kind:"ScalarField",name:"isPrivateBot",storageKey:null},e_={alias:null,args:null,kind:"ScalarField",name:"mayHaveSuggestedReplies",storageKey:null},ef={alias:null,args:null,kind:"ScalarField",name:"supportsResend",storageKey:null},eF={alias:null,args:null,kind:"ScalarField",name:"supportsRemix",storageKey:null},ev={alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"animateToVideoBot",plural:!1,selections:[w,p,ea],storageKey:null},eS={alias:null,args:null,kind:"ScalarField",name:"isTrustedBot",storageKey:null},eC={alias:null,args:null,kind:"ScalarField",name:"noAccessMessage",storageKey:null},eK={alias:null,args:null,kind:"ScalarField",name:"isServerBot",storageKey:null},eM={alias:null,args:null,kind:"ScalarField",name:"uploadFileSizeLimit",storageKey:null},ew={alias:null,args:null,kind:"ScalarField",name:"supportsFileUpload",storageKey:null},eI=[{kind:"Literal",name:"size",value:"small"}],eL={alias:null,args:null,kind:"ScalarField",name:"isDeleted",storageKey:null},eT={alias:"titleText",args:null,kind:"ScalarField",name:"title",storageKey:null},ex={alias:"bodyText",args:null,kind:"ScalarField",name:"body",storageKey:null},eA={alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[V,p,P],storageKey:null},eE={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"primaryImageSources",plural:!0,selections:eD=[X,{kind:"TypeDiscriminator",abstractKey:"__isMessageFollowupActionImageSource"},{kind:"InlineFragment",selections:[p,R,F],type:"MessageAttachment",abstractKey:null},{kind:"InlineFragment",selections:[p,ea,q,Y,ee],type:"Bot",abstractKey:null},{kind:"InlineFragment",selections:y,type:"Node",abstractKey:"__isNode"}],storageKey:null},eB={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"secondaryImageSources",plural:!0,selections:eD,storageKey:null},eN=[w,p],{fragment:{argumentDefinitions:[l,t,s,i,r,o,u,d,c,g],kind:"Fragment",metadata:null,name:"sendMessageMutation",selections:[{alias:null,args:m,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[p,{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[h,b,{kind:"InlineDataFragmentSpread",name:"messagesConnection_message",selections:[p,{args:null,kind:"FragmentSpread",name:"ChatMessagesView_useMessagePairs_messages"},k],args:null,argumentDefinitions:[]},k,{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_newChatUpdater_message",selections:y,args:null,argumentDefinitions:[]}]}],storageKey:null},{args:null,kind:"FragmentSpread",name:"sendMessageMutation_messageEdge"}],storageKey:null},_,f,v,{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[p,S,C,K,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[p,M,w],storageKey:null},{kind:"InlineDataFragmentSpread",name:"sendMessage_newChatUpdater_chat",selections:[p,S,C,{kind:"InlineDataFragmentSpread",name:"getChatContentType_chat",selections:[{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[I],storageKey:null}],args:null,argumentDefinitions:[]}],args:null,argumentDefinitions:[]},{args:null,kind:"FragmentSpread",name:"ChatHistoryListItem_chat"},{args:null,kind:"FragmentSpread",name:"ChatPageColumn_chat"}],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ChatPageColumn_viewer"}],storageKey:null}]},{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{kind:"InlineDataFragmentSpread",name:"sendMessage_newChatUpdater_bot",selections:[L],args:null,argumentDefinitions:[]}]},{kind:"InlineDataFragmentSpread",name:"sendMessage_onSuccessUpdater_bot",selections:[w,L],args:null,argumentDefinitions:[]},{kind:"InlineDataFragmentSpread",name:"setBotDetailsSidebar_bot",selections:[{args:null,kind:"FragmentSpread",name:"ChatBotDetailsSidebar_bot"}],args:null,argumentDefinitions:[]},{args:null,kind:"FragmentSpread",name:"ChatMessageLimitTooltip_bot"}],storageKey:null}],storageKey:null}],type:"MutationRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[s,t,u,g,i,d,l,r,c,o],kind:"Operation",name:"sendMessageMutation",selections:[{alias:null,args:m,concreteType:"MessageEdgeCreate",kind:"LinkedField",name:"messageEdgeCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"message",plural:!1,selections:[p,{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[h,b,p,T,x,A,D,E,B,O,et,es,ei,er,eo,eu,ec,el],storageKey:null},eg],storageKey:null},_,f,v,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[w,M,p,Z,H,z,W,$,Q,q,Y,ee,ea,en,em,eb,ek,ey,e_,ef,eF,ev,eS,eC,eK,eM,ew,{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[el]},el],storageKey:null},{condition:"shouldFetchChat",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Chat",kind:"LinkedField",name:"chat",plural:!1,selections:[p,S,C,K,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBotObject",plural:!1,selections:[p,M,w,I,Y,q,ee,{alias:"smallPicture",args:eI,concreteType:null,kind:"LinkedField",name:"picture",plural:!1,selections:J,storageKey:'picture(size:"small")'},{alias:null,args:null,kind:"ScalarField",name:"viewerIsCreator",storageKey:null},ek,ey,{alias:null,args:null,kind:"ScalarField",name:"viewerIsFollower",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"followerCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shareLink",storageKey:null},ea,en,{alias:null,args:null,kind:"ScalarField",name:"isDown",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"model",storageKey:null},eM,H,eb,{alias:null,args:null,kind:"ScalarField",name:"allowsClearContext",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"conversationStarters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isOfficialBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"monthlyActiveUsers",storageKey:null},{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"creator",plural:!1,selections:[eL,{alias:null,args:eI,kind:"ScalarField",name:"profilePhotoUrl",storageKey:'profilePhotoUrl(size:"small")'},{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},{alias:"nullableHandle",args:null,kind:"ScalarField",name:"handle",storageKey:null},p,el],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},Q,{alias:null,args:null,kind:"ScalarField",name:"poweredBy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptPlaintext",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldHide",storageKey:null},em,Z,z,W,$,e_,ef,eF,ev,eS,eC,eK,ew,el],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastInteractionTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"botMembersCount",storageKey:null},{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"lastMessage",plural:!1,selections:[T,p,x,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[em,w,eb,p,ek,M,Y,ey,e_,ef,eF,ev,q,z,Z,H,W,$,Q,ee,ea,en,eS,eC,eK,eM,ew,el],storageKey:null},A,eo,ei,h,D,eu,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"followupActions",plural:!0,selections:[X,{kind:"TypeDiscriminator",abstractKey:"__isMessageFollowupActionBase"},K,{kind:"InlineFragment",selections:[eT,ex,{alias:null,args:null,kind:"ScalarField",name:"sendText",storageKey:null},{alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"sendAttachments",plural:!0,selections:[N,p,{kind:"InlineFragment",selections:[eA,R,F,U],type:"Attachment",abstractKey:"__isAttachment"}],storageKey:null},eE,eB,{alias:null,args:null,concreteType:"MessageFollowUpTargetBotInfo",kind:"LinkedField",name:"targetBotInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isInChat",storageKey:null},{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[p,{alias:null,args:null,concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[eh,p,ep],storageKey:null},w,M,Y,eS,ea,{alias:null,args:null,kind:"ScalarField",name:"hasUserMessagedRecently",storageKey:null}],storageKey:null}],storageKey:null}],type:"SendMessageFollowupAction",abstractKey:null},{kind:"InlineFragment",selections:[eT,ex,{alias:null,args:null,kind:"ScalarField",name:"prefillText",storageKey:null},{alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"prefillAttachments",plural:!0,selections:[N,p,F,R,{kind:"InlineFragment",selections:[eA,U],type:"Attachment",abstractKey:"__isAttachment"}],storageKey:null},eE,eB],type:"PrefillMessageFollowupAction",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"suggestedReplies",storageKey:null},{alias:null,args:null,concreteType:"MessageAttachment",kind:"LinkedField",name:"attachments",plural:!0,selections:[R,F,p,{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[V,p],storageKey:null},N,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"file",plural:!1,selections:[P],storageKey:null},U],type:"Attachment",abstractKey:"__isAttachment"}],storageKey:null},{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"recommendedBots",plural:!0,selections:eN,storageKey:null},{kind:"ClientExtension",selections:[G,ed]}],storageKey:null},eL,{alias:null,args:eR=[{kind:"Literal",name:"last",value:5}],concreteType:"MessagesConnection",kind:"LinkedField",name:"messagesConnection",plural:!1,selections:[{alias:null,args:null,concreteType:"MessageEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Message",kind:"LinkedField",name:"node",plural:!1,selections:[A,p,h,b,T,x,D,E,B,O,et,es,ei,er,eo,X,ec,el],storageKey:null},p,eg],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"hasPreviousPage",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startCursor",storageKey:null}],storageKey:null},p],storageKey:"messagesConnection(last:5)"},{alias:null,args:eR,filters:null,handle:"connection",key:"ChatMessagesView_chat_messagesConnection",kind:"LinkedHandle",name:"messagesConnection"},{alias:null,args:null,kind:"ScalarField",name:"isContextOptimizationOn",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"membersIncludeUntrustedBot",storageKey:null},el,j],storageKey:null},{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:"allowImages",args:[{kind:"Literal",name:"gateName",value:"poe_allow_images"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_allow_images")'},{alias:"allowImagesForApiBots",args:[{kind:"Literal",name:"gateName",value:"poe_allow_images_for_api_bots"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_allow_images_for_api_bots")'},{alias:"enableImageViewer",args:[{kind:"Literal",name:"gateName",value:"poe_web_image_viewer"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_image_viewer")'},{alias:"enableMath",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_markdown_math"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_markdown_math")'},{alias:null,args:null,kind:"ScalarField",name:"promptBotImageDomainWhitelist",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uid",storageKey:null},{alias:"poeMessageDropdownImageOptions",args:[{kind:"Literal",name:"gateName",value:"poe_message_dropdown_image_options"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_message_dropdown_image_options")'},{alias:"showMessageInfo",args:[{kind:"Literal",name:"gateName",value:"poe_show_message_cost"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_show_message_cost")'},{alias:"enableImageAttachmentsForBots",args:[{kind:"Literal",name:"gateName",value:"poe_enable_image_attachments_for_bots"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_image_attachments_for_bots")'},{alias:"enableVideoAttachmentsForBots",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_video_player"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_video_player")'},{alias:"enableAudioAttachmentsForBots",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_audio_player"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_audio_player")'},{alias:null,args:null,concreteType:"PoeUser",kind:"LinkedField",name:"poeUser",plural:!1,selections:[p,b],storageKey:null},{alias:null,args:null,concreteType:"Subscription",kind:"LinkedField",name:"subscription",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isActive",storageKey:null},p,{alias:null,args:null,kind:"ScalarField",name:"expiresTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"willCancelAtPeriodEnd",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"purchaseRevocationReason",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"planType",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForWebSubscriptions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeWebSubscriptionAnnouncement",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeAndroidSubscriptionAnnouncement",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldSeeResponseSpeedUpsell",storageKey:null},{alias:"enableGTMEventSending",args:[{kind:"Literal",name:"gateName",value:"poe_enable_event_sending_through_google_tag_manager"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_event_sending_through_google_tag_manager")'},{alias:"isPrivateDeletedBotsChangesEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_private_deleted_bots_changes"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_private_deleted_bots_changes")'},{alias:"useNewFollowupActions",args:[{kind:"Literal",name:"gateName",value:"poe_use_new_message_followup_actions_web"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_use_new_message_followup_actions_web")'},{alias:"enableRemixButton",args:[{kind:"Literal",name:"gateName",value:"poe_remix_button_web"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_remix_button_web")'},{alias:"enableInChatRecommendations",args:[{kind:"Literal",name:"gateName",value:"poe_web_in_chat_recommendations"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_in_chat_recommendations")'},{alias:"enableOnlyAnimateFollowupAction",args:[{kind:"Literal",name:"gateName",value:"poe_enable_only_animate_followup_action"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_only_animate_followup_action")'},{alias:null,args:null,kind:"ScalarField",name:"expensiveBotCostThreshold",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleToPurchaseOnAnyPlatform",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"viewerCountryCode",storageKey:null},{alias:null,args:null,concreteType:"MessagePointInfo",kind:"LinkedField",name:"messagePointInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"messagePointResetTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subscriberBonusGrantResetTime",storageKey:null},p],storageKey:null},{alias:"showChatBreakMoreOptionsMenu",args:[{kind:"Literal",name:"gateName",value:"poe_web_more_discoverable_context_clear_delete"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_more_discoverable_context_clear_delete")'},{alias:"decoupleBotHandleAndName",args:[{kind:"Literal",name:"gateName",value:"poe_web_enable_bot_handle_display_name_decoupling"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_bot_handle_display_name_decoupling")'},p,{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"defaultBot",plural:!1,selections:eN,storageKey:null},{alias:"enableInputAreaForNoAccessBots",args:eP=[{kind:"Literal",name:"gateName",value:"poe_web_enable_private_deleted_bots_changes_p2"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_private_deleted_bots_changes_p2")'},{alias:"isMultibotEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_multibot_web"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_multibot_web")'},{alias:"isFilePasteEnabled",args:[{kind:"Literal",name:"gateName",value:"poe_web_file_paste"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_file_paste")'},{alias:"enableEncourageAtMention",args:[{kind:"Literal",name:"gateName",value:"poe_web_input_field_encourage_at_mention"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_input_field_encourage_at_mention")'},{alias:"showNewChatButton",args:[{kind:"Literal",name:"gateName",value:"poe_web_more_discoverable_create_new_chat_button"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_more_discoverable_create_new_chat_button")'},{alias:"enableNewChatButtonForNoAccessBots",args:eP,kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_web_enable_private_deleted_bots_changes_p2")'},{alias:"enablePayByContext",args:[{kind:"Literal",name:"gateName",value:"poe_enable_pay_by_context"}],kind:"ScalarField",name:"booleanGate",storageKey:'booleanGate(gateName:"poe_enable_pay_by_context")'}],storageKey:null}]}],storageKey:null}]},params:{id:"46c089db009ba7793e2a6ce09017d71dc226b80fe4d48b258618598fbbad6828",metadata:{},name:"sendMessageMutation",operationKind:"mutation",text:null}});eV.hash="922b62fd1595e41e65f66ad852ad069a",a.default=eV},88530:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_bot"};l.hash="03d2ef9817ced391e4447fc3a36e2dc3",a.default=l},92750:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_chat"};l.hash="41e13c12a815d056441458d26ccd44e2",a.default=l},39574:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_messageAttachment"};l.hash="3516a5654ecab43280472adcd8637c86",a.default=l},7741:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_newChatUpdater_bot"};l.hash="1b13c18488f888b9a8e194c764eb6af8",a.default=l},87065:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_newChatUpdater_chat"};l.hash="fe289b3648e440d6462f634cd9902a26",a.default=l},13182:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_newChatUpdater_message"};l.hash="a3edfe280a68f7340ebe0be36940756a",a.default=l},4690:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_onMessageSendChatUpdate_chat"};l.hash="3f09cda2a6e7d19e423600d1197a875f",a.default=l},19984:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_onMessageSendChatUpdate_messageAttachment"};l.hash="8bcdc0fdf98f584608cee7a0839e5efd",a.default=l},60706:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_onSuccessUpdater_bot"};l.hash="ee4aaef889ad9dfcd7386da3d64786c3",a.default=l},97048:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"sendMessage_onSuccessUpdater_chat"};l.hash="692e43449c9d5e620c724dfe96e44e61",a.default=l},35813:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useFileUpload_bot",selections:[{alias:null,args:null,kind:"ScalarField",name:"uploadFileSizeLimit",storageKey:null}],type:"Bot",abstractKey:null};l.hash="9411ba544b4a8708972edb3b3b4991d0",a.default=l},15313:function(e,a,n){"use strict";var l,t,s,i,r,o,u,d,c,g,m,p,h;n.r(a);let b=(l={defaultValue:null,kind:"LocalArgument",name:"chatCode"},t={defaultValue:null,kind:"LocalArgument",name:"handle"},s={defaultValue:null,kind:"LocalArgument",name:"hasChat"},i=[{kind:"Variable",name:"name",variableName:"handle"}],r={alias:null,args:null,kind:"ScalarField",name:"canUserAccessBot",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"handle",storageKey:null},d={condition:"hasChat",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[u={kind:"Variable",name:"chatCode",variableName:"chatCode"}],kind:"ScalarField",name:"isInChat",storageKey:null}]},c=[u,{kind:"Variable",name:"hasChat",variableName:"hasChat"}],g=[l,s],{fragment:{argumentDefinitions:[l,t,s],kind:"Fragment",metadata:null,name:"useMultibotAtMentionSelectBotQuery",selections:[{alias:null,args:i,concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[r,{kind:"InlineDataFragmentSpread",name:"useMultibotAtMention_selectBot",selections:[o,{kind:"InlineDataFragmentSpread",name:"ChatMessageInputFooter_selectBot",selections:[o,d,{args:null,kind:"FragmentSpread",name:"ChatPageMain_targetedBot"}],args:c,argumentDefinitions:g},{kind:"InlineDataFragmentSpread",name:"ChatHomeMain_selectBot",selections:[m={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"ChatSubscriptionPaywallContextWrapper_bot"},{args:null,kind:"FragmentSpread",name:"ChatHomeMainInputContainer_bot"},{kind:"InlineDataFragmentSpread",name:"useHomeBotSelector_selectBot",selections:[m,{args:null,kind:"FragmentSpread",name:"BotSelectorHomeMain_bots"}],args:null,argumentDefinitions:[]}],args:null,argumentDefinitions:[]}],args:c,argumentDefinitions:g}],storageKey:null}],type:"QueryRoot",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,l,s],kind:"Operation",name:"useMultibotAtMentionSelectBotQuery",selections:[{alias:null,args:i,concreteType:"Bot",kind:"LinkedField",name:"bot",plural:!1,selections:[r,o,{alias:null,args:null,kind:"ScalarField",name:"supportsRemix",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isTrustedBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"noAccessMessage",storageKey:null},m,{alias:null,args:null,kind:"ScalarField",name:"isServerBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"uploadFileSizeLimit",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"allowsImageAttachments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"supportsFileUpload",storageKey:null},{alias:null,args:null,concreteType:"MessagePointLimit",kind:"LinkedField",name:"messagePointLimit",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipText",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numRemainingMessages",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"balanceTooltipType",storageKey:null},m,{alias:null,args:null,kind:"ScalarField",name:"displayMessagePointPrice",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldShowReminderBanner",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"remainingMessagesLimitReason",storageKey:null}],storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"botId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"nickname",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"deletionState",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isCreatedByPoeUserAccount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"introduction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messageTimeoutSecs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isApiBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"limitedAccessType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shouldHideLimitedAccessTag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"translatedBotTags",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"picture",plural:!1,selections:h=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isBotPicture"},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"localName",storageKey:null}],type:"LocalBotImage",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],type:"URLBotImage",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPrivateBot",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mayHaveSuggestedReplies",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"supportsResend",storageKey:null},{alias:null,args:null,concreteType:"Bot",kind:"LinkedField",name:"animateToVideoBot",plural:!1,selections:[p,m,o],storageKey:null},{alias:"tinyPicture",args:[{kind:"Literal",name:"size",value:"tiny"}],concreteType:null,kind:"LinkedField",name:"picture",plural:!1,selections:h,storageKey:'picture(size:"tiny")'},d,{kind:"TypeDiscriminator",abstractKey:"__isNode"}],storageKey:null}]},params:{id:"d81239a738e0421a478646b876bb1b801d8a205501ddb82ecae6a320eca917d3",metadata:{},name:"useMultibotAtMentionSelectBotQuery",operationKind:"query",text:null}});b.hash="d598aaa2e4ffeb0d25b4ad7018b4b1aa",a.default=b},70275:function(e,a,n){"use strict";n.r(a);let l={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useMultibotAtMention_chat",selections:[{alias:null,args:null,kind:"ScalarField",name:"chatCode",storageKey:null}],type:"Chat",abstractKey:null};l.hash="87c684b4cdea96c44e6ac6ae00edd137",a.default=l},66348:function(e,a,n){"use strict";n.r(a);let l={kind:"InlineDataFragment",name:"useMultibotAtMention_selectBot"};l.hash="f5d5b41d8c2bd79b557d23c20debac76",a.default=l},77172:function(e,a,n){"use strict";var l=n(85893),t=n(67294),s=n(22120),i=n(42240),r=n(87841),o=n.n(r);a.Z=e=>{let{fileHandlerRef:a}=e,n=(0,t.useRef)(null),r=(0,t.useCallback)(e=>{var n;if(!a.current)return;let l=Array.from((null===(n=e.dataTransfer)||void 0===n?void 0:n.files)||[]);l.length&&a.current.handleFiles(l)},[a]),{isDropTargetDraggingOver:u,isDocumentDraggingOver:d}=(0,i.Y)(n,r),{t:c}=(0,s.$G)();return(0,l.jsx)("div",{ref:n,className:o().dropTarget,"data-visible":d,"data-active":u,children:c("Drop files here")})}},54032:function(e,a,n){"use strict";n.d(a,{Z:function(){return eK}});var l,t,s,i,r,o=n(85893),u=n(5152),d=n.n(u),c=n(67294),g=n(22578),m=n(49169),p=n(2012),h=n(41019),b=n(81534),k=n(37650),y=n(8655),_=n(47986),f=n(38154),F=n.n(f),v=n(77614),S=n(22120),C=n(69295),K=n(25533),M=n(89846),w=n(1656),I=n(70442),L=n.n(I),T=n(81952),x=n.n(T);let A=(0,c.forwardRef)((e,a)=>{let[n,l]=(0,c.useState)(null),[t,s]=(0,c.useState)(0),i=(0,c.useRef)(null);return(0,c.useImperativeHandle)(a,()=>({setTooltip:e=>{l(e),s(e=>e+1),null!==i.current&&clearTimeout(i.current),i.current=window.setTimeout(()=>{l(null)},5e3)}}),[]),n?(0,o.jsx)("div",{className:x().tooltip,children:n},t):null});A.displayName="Tooltip";let D=(0,c.forwardRef)((e,a)=>{let{viewer:l,onFileUpload:t,...s}=e,{isMultibotEnabled:i}=(0,g.useFragment)(n(51013),l),r=(0,c.useRef)(null),{t:u}=(0,S.$G)(),d=(0,c.useCallback)(()=>{var e;null==r||null===(e=r.current)||void 0===e||e.click()},[]),m=(0,c.useCallback)(e=>{if(e.target.files){let a=Array.from(e.target.files);e.target.value="",t(a)}},[t]),p=(0,c.useRef)(null);(0,c.useImperativeHandle)(a,()=>({setTooltip:e=>{var a;return null===(a=p.current)||void 0===a?void 0:a.setTooltip(e)}}));let[h,b]=(0,c.useState)(null),k=u("Select attachment");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{children:[(0,o.jsx)(C.t9,{className:L().button,onClick:d,ref:b,...s,children:i?(0,o.jsx)(M.Z,{}):(0,o.jsx)(w.Z,{})}),(0,o.jsx)(A,{ref:p}),(0,o.jsx)(K.Z,{anchorRef:h,label:k,placement:"top"})]}),(0,o.jsx)("input",{className:L().input,ref:r,type:"file",multiple:!0,onChange:m})]})});D.displayName="ChatMessageFileInputButton";var E=n(39620),B=n(34616),N=n(25432),R=n.n(N),patterns_Dismissable=e=>{let{children:a,onDismiss:n,className:l}=e,t=(0,c.useCallback)(e=>{e.stopPropagation(),n()},[n]);return(0,o.jsxs)("div",{className:(0,B.$)(R().dismissableContainer,l),children:[a,(0,o.jsx)("button",{className:R().dismissButton,onClick:t,children:(0,o.jsx)(E.Z,{className:R().icon})})]})},P=n(39128),V=n(89942),G=n(30498),j=n(47180),U=n.n(j);let ChatMessageInputAttachment=e=>{let{file:a,viewer:l,index:t,onDismiss:s}=e,i=(0,c.useCallback)(()=>{s(t)},[s,t]),r=(0,g.useFragment)(n(12699),l),u=(0,G.J$)(n(31168),a);return(0,o.jsx)(patterns_Dismissable,{className:U().attachment,onDismiss:i,children:(0,o.jsx)(P.Z,{file:u,viewer:r})})};var inputFooter_ChatMessageInputAttachments=e=>{let{files:a,viewer:l,fileIds:t,onFileRemoved:s}=e,i=(0,c.useCallback)(e=>{s(e)},[s]),r=(0,g.useFragment)(n(64192),l),u=(0,G.mj)(n(74083),a);return a.length?(0,o.jsx)(V.Z,{className:U().container,children:u.map((e,a)=>(0,o.jsx)(ChatMessageInputAttachment,{file:e,viewer:r,index:a,onDismiss:i},t[a]))}):null},O=n(44311),Z=n(8787),H=n(92002),z=n.n(H),W=n(26897),$=n(57758),Q=n(67275),q=n(79500),Y=n(68702),X=n.n(Y);(l=s||(s={})).base="base",l.warning="warning";var J=s,ee=n(44720),inputFooter_ChatMessageLimitTooltip=e=>{let{bot:a,viewer:l}=e,t=(0,g.useFragment)(n(80946),a),{subscription:s,isEligibleForWebSubscriptions:i}=(0,g.useFragment)(n(27738),l),{messagePointLimit:r,botId:u}=t,{setBotId:d}=(0,c.useContext)(W.J),{isLoggedInUser:h}=(0,p.b)(),k=(0,g.useRelayEnvironment)(),y=(0,c.useRef)(null),_=(0,c.useCallback)(()=>{h&&null==y.current&&(y.current=u,(0,g.fetchQuery)(k,n(73230),{botId:u},{fetchPolicy:"network-only"}).subscribe({complete:()=>{y.current=null},error:()=>{y.current=null}}))},[u,k,h,y]);(0,Q.zw)(_);let f=h?r.balanceTooltipText:null,F=!!f,{openPaywall:S}=(0,m.rk)(),K=v.Z.pill_tooltip,{logImpression:M,logClick:w,getViewableImpressionData:I}=(0,b.hz)(t),{ref:L}=(0,q.Z)(ee.Z.web_subscriptions,{additionalLogData:I(K)}),T=h&&0===r.numRemainingMessages&&!(null==s?void 0:s.isActive)&&i;(0,c.useEffect)(()=>{F&&T&&M(K)},[F,T,M,K]);let x=(0,c.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),T?(w(K),S()):d(u)},[S,w,K,u,T,d]),A=r.balanceTooltipType==J.warning?X().tooltipNotMuted:X().tooltipMuted;return F?(0,o.jsxs)(C.t9,{className:(0,B.$)(X().noFreeMessageTooltip,A,h?X().tooltipClickable:X().tooltipNonClickable),onClick:x,ref:T?L:void 0,children:[f,h&&(0,o.jsx)($.Z,{className:X().chevronIcon})]}):null},inputFooter_ChatMessageSendButton=e=>{let{bot:a,viewer:l,className:t,...s}=e,{t:i}=(0,S.$G)(),r=(0,g.useFragment)(n(72612),a),u=(0,g.useFragment)(n(19117),l),[d,m]=(0,c.useState)(null),p=i("Send message");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(C.DF,{ref:m,className:(0,B.$)(z().sendButton,t),...s,children:(0,o.jsx)(Z.Z,{})}),(0,o.jsx)(K.Z,{anchorRef:d,label:p,placement:"top"}),(0,o.jsx)(inputFooter_ChatMessageLimitTooltip,{bot:r,viewer:u})]})},ea=n(74929),en=n(37115),el=n(71953),et=n.n(el);let useValueChangeListeners=e=>{let a=(0,c.useRef)([]),n=(0,c.useCallback)(e=>{a.current.forEach(a=>a(e))},[]),l=(0,c.useCallback)(e=>{n(e.target.value)},[n]),t=(0,c.useCallback)(n=>{if(a.current.push(n),1===a.current.length){var t;null===(t=e.current)||void 0===t||t.addEventListener("input",l)}},[e,l]),s=(0,c.useCallback)(n=>{if(a.current=a.current.filter(e=>e!==n),0===a.current.length){var t;null===(t=e.current)||void 0===t||t.removeEventListener("input",l)}},[e,l]);return(0,c.useEffect)(()=>()=>{var a;null===(a=e.current)||void 0===a||a.removeEventListener("input",l)},[e,l]),{addValueChangedListener:t,removeValueChangedListener:s,onValueChange:n}},usePlaceholderOverflow=(e,a)=>{let n=(0,c.useRef)(null),l=(0,c.useRef)(null),t=(0,c.useRef)([]),s=(0,c.useCallback)(e=>{t.current.forEach(a=>a(e))},[]),i=(0,c.useCallback)(e=>{t.current.push(e)},[]),r=(0,c.useCallback)(e=>{t.current=t.current.filter(a=>a!==e)},[]);(0,c.useEffect)(()=>{if(!a.current||!e.current)return;let t=new ResizeObserver(e=>{n.current=null==e?void 0:e[0].borderBoxSize[0].inlineSize,s(e)}),i=new ResizeObserver(e=>{var a;l.current=null==e?void 0:null===(a=e[0].contentBoxSize)||void 0===a?void 0:a[0].inlineSize,s(e)});return t.observe(e.current),i.observe(a.current),()=>{t.disconnect(),i.disconnect()}},[e,a,s]);let o=(0,c.useCallback)(e=>null!==l.current&&null!==n.current&&!!a.current&&(a.current.textContent=e,l.current>n.current),[a]);return{addPlaceholderResizeListener:i,removePlaceholderResizeListener:r,getPlaceholderOverflow:o}},es=(0,c.forwardRef)((e,a)=>{let{className:n,onInput:l,onChange:t,footer:s,placeholder:i,...r}=e,u=(0,c.useRef)(null),d=(0,c.useRef)(null),g=(0,c.useRef)(null),m=(0,ea.G6)((0,en.F)()),p=(0,c.useCallback)(()=>{if(u.current&&d.current){var e;u.current.dataset.replicatedValue=d.current.value,m&&((e=d.current).scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth)&&requestAnimationFrame(()=>{u.current&&(u.current.style.transform="translateY(0)",u.current.style.transform="unset")})}},[m]),h=(0,c.useCallback)(e=>{null==l||l(e),p()},[l,p]),{addValueChangedListener:b,removeValueChangedListener:k,onValueChange:y}=useValueChangeListeners(d),{getPlaceholderOverflow:_,addPlaceholderResizeListener:f,removePlaceholderResizeListener:F}=usePlaceholderOverflow(d,g);return(0,c.useImperativeHandle)(a,()=>({focus:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.focus()},blur:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.blur()},addEventListener:(e,a,n)=>{var l;return null===(l=d.current)||void 0===l?void 0:l.addEventListener(e,a,n)},removeEventListener:(e,a,n)=>{var l;return null===(l=d.current)||void 0===l?void 0:l.removeEventListener(e,a,n)},getValue:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.value},setValue:(e,a)=>{if(!d.current)return;let n=d.current.selectionStart,l=d.current.selectionEnd;d.current.value=e,d.current.scrollTo(0,d.current.scrollHeight),p(),a&&d.current.setSelectionRange(...a(n,l)),y(e)},addValueChangedListener:b,removeValueChangedListener:k,getSelectionStart:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.selectionStart},getSelectionEnd:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.selectionEnd},setSelectionRange:(e,a,n)=>{var l;return null===(l=d.current)||void 0===l?void 0:l.setSelectionRange(e,a,null!=n?n:"none")},getPlaceholderOverflow:_,addPlaceholderResizeListener:f,removePlaceholderResizeListener:F}),[p,b,k,y,_,f,F]),(0,o.jsxs)("div",{className:(0,B.$)(et().growWrap,n),ref:u,children:[(0,o.jsx)("textarea",{className:et().textArea,ref:d,rows:1,onInput:h,onChange:t,placeholder:i,...r}),(0,o.jsx)("div",{className:et().hidden,ref:g}),s]})});es.displayName="GrowingTextArea";var ei=n(52667);(t=i||(i={}))[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.SPACE=32]="SPACE",t[t.ESC=27]="ESC",t[t.UP=38]="UP",t[t.DOWN=40]="DOWN",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.HOME=36]="HOME",t[t.END=35]="END";var er=i;let getLastHumanMessageText=e=>{if(!e)return null;for(let a=e.length-1;a>=0;a--){let{node:l}=(0,g.readInlineData)(n(87330),e[a]);if((0,ei.Q1)(l))return l.text}return null},useOnKeyDown=(e,a,l,t,s,i)=>{let r=(0,g.useFragment)(n(91963),e),{shouldPromptSubscription:o,openPaywall:u}=(0,m.rk)(),d=(0,c.useCallback)(e=>{e.preventDefault(),!i&&o?(s(v.Z.limited_access_bot),u()):l()},[i,o,s,u,l]),p=(0,c.useCallback)(e=>{var n,l;if(!(null===(n=a.current)||void 0===n?void 0:n.getValue())){e.preventDefault();let n=getLastHumanMessageText(r);n&&(null===(l=a.current)||void 0===l||l.setValue(n),t())}},[r,a,t]);return(0,c.useCallback)(e=>{e.shiftKey||e.keyCode!=er.ENTER?e.keyCode==er.UP&&p(e):d(e)},[d,p])},eo=(0,c.forwardRef)((e,a)=>{let{edges:l,bot:t,className:s,submitMessage:i,onChange:r,disabled:u,footer:d,placeholderText:p,viewer:h,onPaste:k}=e,_=(0,g.useFragment)(n(97369),h),f=(0,g.useFragment)(n(73938),l),F=(0,g.useFragment)(n(9883),t),S=(0,c.useRef)(null),{logClick:C}=(0,b.hz)(F),K=useOnKeyDown(f,S,i,r,C,_.isMultibotEnabled),{shouldPromptSubscription:M,openPaywall:w}=(0,m.rk)(),I=(0,c.useCallback)(()=>{var e;null===(e=S.current)||void 0===e||e.setValue(""),C(v.Z.limited_access_bot),w()},[C,w]),L=(0,c.useMemo)(()=>(0,y.Z)([S,a]),[S,a]),T=(0,c.useCallback)(()=>{!_.isMultibotEnabled&&M&&I()},[I,M,_.isMultibotEnabled]),x=(0,c.useRef)(!1),A=!_.isMultibotEnabled&&M?()=>{x.current||(I(),x.current=!0)}:void 0;return(0,o.jsx)(es,{ref:L,className:s,placeholder:p,onFocus:A,onInput:T,onChange:r,onKeyDown:K,onPaste:k,disabled:u,footer:d})});eo.displayName="ChatMessageTextArea";var eu=n(41143),ed=n.n(eu),ec=n(63236);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}var microphone=function(e){return c.createElement("svg",_extends({viewBox:"0 0 16 27",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=c.createElement("path",{clipRule:"evenodd",d:"M4.235 1.803C4.848.823 6.013 0 8 0c1.986 0 3.152.824 3.765 1.803a3.826 3.826 0 0 1 .568 1.836V3.664s0 .003-1 .003h1v10.666h-1 1v.028a1.823 1.823 0 0 1-.01.176 3.827 3.827 0 0 1-.558 1.66C11.152 17.177 9.986 18 8 18c-1.987 0-3.152-.824-3.765-1.803a3.828 3.828 0 0 1-.568-1.836V14.336s0-.003 1-.003h-1V3.667h1-1v-.028a2.004 2.004 0 0 1 .01-.176 3.827 3.827 0 0 1 .558-1.66Zm1.432 1.874.002-.036a1.828 1.828 0 0 1 .262-.778C6.152 2.51 6.653 2 8 2s1.848.51 2.069.863a1.83 1.83 0 0 1 .264.814v10.646l-.002.036a1.83 1.83 0 0 1-.262.778c-.221.353-.722.863-2.07.863-1.346 0-1.847-.51-2.068-.863a1.828 1.828 0 0 1-.264-.814V3.677Zm-4.334 4.99a1 1 0 0 1 1 1v4.666l.001.03a5.657 5.657 0 0 0 .087.725c.09.49.27 1.13.62 1.76a4.464 4.464 0 0 0 1.62 1.69c.76.457 1.827.795 3.339.795s2.579-.338 3.34-.795a4.464 4.464 0 0 0 1.62-1.69c.349-.63.528-1.27.62-1.76a5.642 5.642 0 0 0 .086-.724V9.667a1 1 0 1 1 2 0v4.666h-1 1v.035a3.958 3.958 0 0 1-.016.302 7.653 7.653 0 0 1-.104.783 7.85 7.85 0 0 1-.839 2.366 6.464 6.464 0 0 1-2.338 2.434c-.902.541-2.013.914-3.37 1.037v3.377h4.334a1 1 0 0 1 0 2H2.667a1 1 0 1 1 0-2H7v-3.378c-1.356-.122-2.467-.495-3.369-1.036a6.463 6.463 0 0 1-2.339-2.434 7.852 7.852 0 0 1-.838-2.366 7.66 7.66 0 0 1-.118-1.015 3.637 3.637 0 0 1-.002-.07v-.032s0-.003 1-.003h-1V9.667a1 1 0 0 1 1-1Z"})))},eg=n(62341),em=n(19029),ep=n(3350),eh=n.n(ep),eb=n(6488),ek=n(39885);let getSpeechRecognition=()=>{let{userAgent:e}=window.navigator;return(0,ea.P)(e)?null:"undefined"!=typeof SpeechRecognition?SpeechRecognition:"undefined"!=typeof webkitSpeechRecognition?webkitSpeechRecognition:null},getMessageFromErrorEvent=(e,a)=>{switch(a.error){case"no-speech":return e("No speech was detected. Try again.");case"audio-capture":return e("No microphone was found. Ensure that a microphone is installed and that microphone settings are configured correctly.");case"not-allowed":return e("Permission to use microphone was denied. Update your browser permission settings and try again.");case"network":return e("A network error occurred. Check your internet connection and try again.");case"language-not-supported":return e("The language {{language}} is not supported by your browser.",{language:(null==a?void 0:a.target)&&"lang"in a.target&&a.target.lang||"en"});case"aborted":if("No speech detected"===a.message)return e("No speech was detected. Try again.");return null;default:return e("An error occurred: {{error}}",{error:a.error})}};let SpeechRecognitionError=class SpeechRecognitionError extends eg.n9{constructor(e){let a=[e.error,e.message].filter(Boolean).join(": ");super(a),this.name="SpeechRecognitionError"}};let logErrorEvent=e=>{("aborted"!==e.error||"No speech detected"===e.message)&&(0,eg.H)(new SpeechRecognitionError(e))},createRecognition=e=>{let{onStart:a,onEnd:n,onError:l,onResult:t}=e,s=getSpeechRecognition();ed()(s,"SpeechRecognition is not supported");let i=new s;return i.continuous=!0,i.interimResults=!0,i.onstart=a,i.onspeechend=()=>{i.stop()},i.onend=n,i.onerror=l,i.onresult=t,i},useSpeechRecognition=(e,a,n)=>{let{t:l}=(0,S.$G)(),[t,s]=(0,c.useState)(!1),i=(0,c.useRef)(!1),r=(0,c.useCallback)(()=>i.current,[]),o=(0,c.useContext)(ec.Z),u=(0,c.useRef)(null),d=(0,c.useCallback)(()=>{var e;null===(e=u.current)||void 0===e||e.stop(),u.current=null},[]),g=(0,c.useCallback)(()=>{var e;null===(e=u.current)||void 0===e||e.abort(),u.current=null},[]),m=(0,c.useCallback)(()=>{var t;let r=(null===(t=e.current)||void 0===t?void 0:t.getValue())||"",c=null==o?void 0:o.botId,g=null==o?void 0:o.model,m=null==o?void 0:o.chatId,p=createRecognition({onStart:()=>{var a,n;null===(a=e.current)||void 0===a||a.blur(),null===(n=e.current)||void 0===n||n.addEventListener("focus",d),s(!0),(0,em.Z)("poe/action_log",{action_type:(0,ek.E)(eb.Z.start_voice_record),bot_id:c,chat_id:m,model_name:g})},onEnd:()=>{var a,n;s(!1),null===(a=e.current)||void 0===a||a.focus(),null===(n=e.current)||void 0===n||n.removeEventListener("focus",d),(0,em.Z)("poe/action_log",{action_type:(0,ek.E)(eb.Z.finish_voice_record),bot_id:c,chat_id:m,model_name:g})},onError:e=>{logErrorEvent(e);let a=getMessageFromErrorEvent(l,e);if(a){var t;null===(t=n.current)||void 0===t||t.setTooltip(a)}},onResult:n=>{let{results:l}=n;if(u.current===p){let n=Array.from(l).filter(e=>e[0].confidence>0).map(e=>e[0].transcript).join("");if(n){var t;i.current=!0,null===(t=e.current)||void 0===t||t.setValue(r+n),a()}}}});u.current=p,p.start()},[e,a,s,n,d,l,o]);return(0,c.useEffect)(()=>{let a=e.current,resetVoiceInputWhenClearInput=e=>{""==e&&(i.current=!1)};return null==a||a.addValueChangedListener(resetVoiceInputWhenClearInput),()=>{null==a||a.removeValueChangedListener(resetVoiceInputWhenClearInput)}},[e]),(0,c.useEffect)(()=>()=>{g()},[g]),{isRunning:t,startRecognition:m,stopRecognition:d,abortRecognition:g,getVoiceInputUsed:r}},ey=(0,c.forwardRef)((e,a)=>{let{className:n,chatInputRef:l,onInputChange:t,...s}=e,i=(0,c.useRef)(null),{t:r}=(0,S.$G)(),{isRunning:u,startRecognition:d,stopRecognition:g,abortRecognition:m,getVoiceInputUsed:p}=useSpeechRecognition(l,t,i);(0,c.useImperativeHandle)(a,()=>({startRecognition:d,stopRecognition:g,abortRecognition:m,getVoiceInputUsed:p}),[d,g,m,p]);let[h,b]=(0,c.useState)(null),k=r("Use microphone");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(C.t9,{className:(0,B.$)(eh().button,n),onClick:u?g:d,ref:b,"aria-selected":!!u,...s,children:[(0,o.jsx)(A,{ref:i}),(0,o.jsx)(microphone,{})]}),(0,o.jsx)(K.Z,{anchorRef:h,label:k,placement:"top"})]})});ey.displayName="ChatMessageVoiceInputButtonInner";let e_=(0,c.forwardRef)((e,a)=>{let[n,l]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{l(!!getSpeechRecognition())},[]),n?(0,o.jsx)(ey,{ref:a,...e}):null});e_.displayName="ChatMessageVoiceInputButton";var ef=n(52958),eF=n(67991);let getFileSizeErrorMessage=(e,a,n)=>{let[l,t]=(0,ef.w)(e);return 0==l?n("The bot you are trying to chat with does not accept attachments."):a<=1?n("The file you tried to attach is too large. Please try uploading a file that is less than {{limit, number}}.",{limit:l,style:"unit",unit:t,unitDisplay:"short"}):a>1?n("The files you tried to attach are too large. Please try uploading files that are less than {{limit, number}} total.",{limit:l,style:"unit",unit:t,unitDisplay:"short"}):void 0};var inputFooter_useFileUpload=(e,a)=>{let{onFileChange:l,onError:t}=a,{uploadFileSizeLimit:s}=(0,g.useFragment)(n(35813),e),[i,r]=(0,c.useState)([]),o=(0,c.useRef)(0),u=(0,c.useRef)(0),d=(0,c.useRef)(new WeakMap),{t:m}=(0,S.$G)(),p=(0,c.useCallback)(e=>{let a;e.forEach(e=>{d.current.set(e,o.current++),(0,eF.a)(e)}),r(a=>{let n=[...a,...e];return null==l||l(n),n});let n=e.reduce((e,a)=>e+a.size,0);u.current+=n,u.current>s&&(a=getFileSizeErrorMessage(s,i.length,m)),a&&(null==t||t(a))},[i,l,t,s,m]),h=(0,c.useCallback)(e=>{let a;r(a=>{let n=a.filter((a,n)=>n!==e);return null==l||l(n),n});let n=i[e].size;u.current-=n,u.current>s&&(a=getFileSizeErrorMessage(s,i.length,m)||""),a&&(null==t||t(a))},[i,l,t,s,m]),b=(0,c.useCallback)(()=>{r(()=>(null==l||l([]),[])),u.current=0},[l]),k=i.map(e=>d.current.get(e)||0);return{files:i,fileIds:k,handleFileUpload:p,handleFileRemove:h,clearFiles:b,totalFileSize:u.current}},ev=n(72566);let getInvalidMentiontedBotMessage=(e,a)=>a("The bot {{handle}} does not exist. Check for typos.",{handle:e});var inputFooter_useMultibotAtMention=e=>{let{chat:a,selectBot:l,setInputErrorMessage:t,chatInputRef:s,botSelectorRef:i}=e,r=(0,g.useFragment)(n(70275),a),o=(0,c.useRef)(null),u=(0,g.useRelayEnvironment)(),{t:d}=(0,S.$G)(),m=(0,c.useCallback)(e=>{let a=(0,O.readInlineData)(n(66348),e);if(o.current=(null==a?void 0:a.handle)||null,l(a),e){var t;null===(t=s.current)||void 0===t||t.focus()}},[s,l]),p=(0,c.useCallback)(async e=>{if(o.current===e)return;if(o.current=e,e.length<4){m(null),t(getInvalidMentiontedBotMessage(e,d));return}t(null);let a=await (0,O.fetchQuery)(u,n(15313),{handle:e,chatCode:(null==r?void 0:r.chatCode)||"",hasChat:!!r},{fetchPolicy:"store-or-network"}).toPromise();if(o.current===e){var l;m((null==a?void 0:null===(l=a.bot)||void 0===l?void 0:l.canUserAccessBot)?null==a?void 0:a.bot:null),(null==a?void 0:a.bot)&&a.bot.canUserAccessBot||t(getInvalidMentiontedBotMessage(e,d))}},[r,u,m,t,d]),h=(0,c.useCallback)(()=>{var e,a,n,l,r,o,u,d,c;let g=(null===(e=s.current)||void 0===e?void 0:e.getValue())||"",h=ev.z.exec(g),b=null==h?void 0:null===(a=h.groups)||void 0===a?void 0:a.handle;void 0!==b?((null===(n=s.current)||void 0===n?void 0:n.getSelectionStart())||0)<=b.length+1?(null===(r=i.current)||void 0===r||null===(l=r.setInput)||void 0===l||l.call(r,b.toLowerCase()),t(null)):(null===(u=i.current)||void 0===u||null===(o=u.setInput)||void 0===o||o.call(u,null),p(b)):(null===(c=i.current)||void 0===c||null===(d=c.setInput)||void 0===d||d.call(c,null),m(null),t(null))},[i,s,m,p,t]);return{onInputChange:h,selectBot:m}};let importAddBotToChatModal=()=>Promise.all([n.e(2947),n.e(4731)]).then(n.bind(n,12947)),eS=d()(()=>n.e(9510).then(n.bind(n,49510)),{loadableGenerated:{webpack:()=>[49510]},ssr:!1}),eC=(0,c.forwardRef)((e,a)=>{let{bot:l,viewer:t,edges:s,chat:i,disableSend:r,onSubmitMessage:u,placeholderText:d,isBotResponding:f,fileHandlerRef:S,setAttachedFilesCount:C,shouldShowNewMemberWarningModal:K,selectBot:M,setInputErrorMessage:w,onInputCleared:I}=e,L=(0,g.useFragment)(n(5466),l),T=(0,g.useFragment)(n(42785),s),{enableInputAreaForNoAccessBots:x,...A}=(0,g.useFragment)(n(50467),t),E=(0,g.useFragment)(n(60352),i),B=(0,c.useRef)(null),{isLoggedInUser:N}=(0,p.b)(),R=L.uploadFileSizeLimit,P=(0,c.useCallback)(e=>{var a,n;q((null===(n=z.current)||void 0===n?void 0:null===(a=n.getValue())||void 0===a?void 0:a.trim())===""&&0===e.length),null==C||C(e.length)},[C]),V=(0,c.useCallback)(e=>{var a;null===(a=B.current)||void 0===a||a.setTooltip(e)},[]),{files:G,fileIds:j,handleFileUpload:U,handleFileRemove:O,clearFiles:Z,totalFileSize:H}=inputFooter_useFileUpload(L,{onFileChange:P,onError:V});(0,c.useImperativeHandle)(S,()=>({handleFiles:U,clearAllFiles:Z}),[U,Z]);let z=(0,c.useRef)(null),W=(0,c.useRef)(null),$=(0,c.useMemo)(()=>(0,y.Z)([z,a]),[z,a]),[Q,q]=(0,c.useState)(!0),[Y,X]=(0,c.useState)(!1),J=0!==G.length,ee=(0,c.useRef)(null),{selectBot:ea,onInputChange:en}=inputFooter_useMultibotAtMention({chat:E||null,selectBot:M,setInputErrorMessage:w,chatInputRef:z,botSelectorRef:ee}),el=(0,c.useCallback)(()=>{var e;let a=(null===(e=z.current)||void 0===e?void 0:e.getValue())||"",n=(null==a?void 0:a.trim())===""&&!J;q(n),en(),n&&(null==I||I())},[J,en,I]),{isDeleted:et}=(0,k.iZ)(L),es=r||!x&&et||f||Q||H>R||Y,ei=(0,c.useCallback)(()=>{var e,a;if(null===(e=W.current)||void 0===e||e.abortRecognition(),navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&(null===(a=z.current)||void 0===a||a.blur()),!es)return u(z,W,G,Z)},[z,W,G,Z,es,u]),er=(0,c.useCallback)(()=>{var e;null===(e=z.current)||void 0===e||e.focus()},[z]),eu=(0,c.useRef)(!1);(0,c.useEffect)(()=>{var e;!N&&!0===eu.current||navigator.maxTouchPoints&&navigator.maxTouchPoints>0||(null===(e=z.current)||void 0===e||e.focus(),eu.current=!0)},[L.id,N]),(0,c.useEffect)(()=>{let e=z.current;return null==e||e.addValueChangedListener(el),()=>{null==e||e.removeValueChangedListener(el)}},[el]);let ed=et||!L.allowsImageAttachments&&H>R,ec=function(e){let{handleFileUpload:a,isFilePasteEnabled:n,isFileInputDisabled:l}=e;return(0,c.useCallback)(e=>{if(l||!n)return;let t=function(e){var a,n;let l=Array.from((null===(a=e.clipboardData)||void 0===a?void 0:a.files)||[]);if(0===l.length)return[];let t=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/html");return t&&!function(e){try{var a;let n=new DOMParser().parseFromString(e,"text/html");return 1===n.body.childElementCount&&(null===(a=n.body.firstElementChild)||void 0===a?void 0:a.tagName)==="IMG"}catch(e){return console.error("there was an issue parsing pasted html"),!1}}(t)?[]:l}(e);0!==t.length&&(a(t),e.preventDefault())},[a,n,l])}({isFileInputDisabled:ed,isFilePasteEnabled:A.isFilePasteEnabled,handleFileUpload:U}),{shouldPromptSubscription:eg,openPaywall:em}=(0,m.rk)(),{logClick:ep}=(0,b.hz)(L),eh=(0,c.useCallback)(()=>{ep(v.Z.limited_access_bot),em()},[ep,em]),[eb,ek]=(0,c.useState)(!1),ey=(0,c.useCallback)(()=>{if(navigator.maxTouchPoints&&navigator.maxTouchPoints>0){var e;null===(e=z.current)||void 0===e||e.blur()}ek(!0)},[ek]),ef=(0,c.useCallback)(()=>{ek(!1),ei()},[ek,ei]),eF=(0,c.useCallback)(()=>{ek(!1)},[ek]),ev=(0,c.useMemo)(()=>({close:eF,botHandle:L.handle,onSubmitAndClose:ef}),[L.handle,eF,ef]),eC=(0,c.useRef)(!1),eK=(0,c.useCallback)(()=>{if(eg){eh();return}if(K){ey();return}ei(),eC.current||((0,_.nL)(_.wy.SendChatClicked),eC.current=!0)},[eg,ei,eh,ey,K]),eM=(0,c.useRef)(null);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(h.Z,{isOpen:eb,onRequestClose:eF,body:importAddBotToChatModal,bodyProps:ev,variant:"compact"}),(0,o.jsxs)("div",{ref:eM,className:F().inputContainer,onClickCapture:er,children:[(0,o.jsx)(eS,{className:F().botSelector,selectorRef:ee,anchorRef:eM,chatInputRef:z,chat:E,selectBot:ea,onIsActiveChange:X}),(0,o.jsx)(eo,{ref:$,edges:T,bot:L,className:F().textArea,submitMessage:eK,onChange:el,disabled:!x&&et,placeholderText:d,onPaste:ec,footer:(0,o.jsx)(inputFooter_ChatMessageInputAttachments,{files:G,viewer:A,fileIds:j,onFileRemoved:O}),viewer:A}),(0,o.jsx)(D,{viewer:A,disabled:ed,onFileUpload:U,ref:B}),(0,o.jsx)(e_,{ref:W,className:F().voiceInputButton,chatInputRef:z,onInputChange:el,disabled:et}),(0,o.jsx)(inputFooter_ChatMessageSendButton,{className:F().sendButton,bot:L,viewer:A,onClick:eK,disabled:es})]})]})});eC.displayName="ChatMessageInputContainer";var eK=eC},72566:function(e,a,n){"use strict";n.d(a,{z:function(){return l}});let l=RegExp("^(?<mention>\\s*@(?<handle>\\S*)\\s?)")},23457:function(e,a,n){"use strict";n.d(a,{Z:function(){return patterns_WarningBanner}});var l,t,s=n(85893),i=n(67294);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}var caution_2=function(e){return i.createElement("svg",_extends({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},e),l||(l=i.createElement("path",{d:"M8.001 12.333a.833.833 0 1 0 0-1.666.833.833 0 0 0 0 1.666ZM7.999 10.167c.366 0 .666-.3.666-.667V6.167c0-.367-.3-.667-.666-.667-.367 0-.667.3-.667.667V9.5c0 .367.3.667.667.667Z"})),t||(t=i.createElement("path",{d:"M14.107 11.173 9.734 3.527a2 2 0 0 0-2.727-.747c-.307.18-.567.44-.74.747l-4.373 7.646c-.267.467-.334 1-.194 1.52.14.514.474.947.94 1.214.3.173.647.266.994.266h8.74c1.1 0 2-.9 2-2a2.075 2.075 0 0 0-.267-1Zm-1.74 1.66H3.634a.665.665 0 0 1-.647-.493.642.642 0 0 1 .067-.507L7.42 4.187a.664.664 0 0 1 1.153 0l4.374 7.646c.06.1.087.214.087.334a.664.664 0 0 1-.667.666Z"})))},r=n(34616),o=n(15490),u=n.n(o),patterns_WarningBanner=e=>{let{className:a,text:n}=e;return(0,s.jsxs)("div",{className:(0,r.$)(u().banner,a),children:[(0,s.jsx)("div",{className:u().iconContainer,children:(0,s.jsx)(caution_2,{})}),n]})}},21774:function(e,a,n){"use strict";n.d(a,{Mo:function(){return clearNonce},Us:function(){return useResendMessage},gc:function(){return setNonceArgs}});var l=n(41143),t=n.n(l),s=n(67294),i=n(22120),r=n(22578),o=n(44311),u=n(12211),d=n(59519),c=n(44912),g=n(24772);let m=new Map,getArgs=e=>{let a=m.get(e);if(!a)throw Error("No args for nonce ".concat(e));return a},setNonceArgs=(e,a)=>m.set(e,a),clearNonce=e=>m.delete(e),resendMessage=e=>{let{environment:a,message:l,bot:s,chat:i,setToast:r,setBotDetailsSidebar:u,onSuccessfulMessageSend:d,t:m}=e,{id:p,isOptimistic:h,clientNonce:b}=(0,o.readInlineData)(n(71669),l),k=(0,o.readInlineData)(n(17048),i),y=(0,o.readInlineData)(n(14973),s);t()(h&&b,"Message must be optimistic to resend");let{optimisticUpdate:_,...f}=getArgs(b);(0,o.commitLocalUpdate)(a,e=>{let a=e.get(k.id);t()(a,"Expected chat record ".concat(k.id," to exist")),(0,c.T5)(a,p)}),a.revertUpdate(_),(0,g.b)({environment:a,chat:k,bot:y,setToast:r,setBotDetailsSidebar:u,onSuccessfulMessageSend:d,t:m,...f})},useResendMessage=e=>{let{message:a,chat:n,bot:l}=e,t=(0,r.useRelayEnvironment)(),o=(0,u.ZP)(),c=(0,d.X)(),{t:g}=(0,i.$G)();return(0,s.useCallback)(function(){let{onSuccessfulMessageSend:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};resendMessage({environment:t,message:a,bot:l,chat:n,setToast:o,setBotDetailsSidebar:c,onSuccessfulMessageSend:a=>{null==e||e(a)},t:g})},[t,o,c,a,l,n,g])}},24772:function(e,a,n){"use strict";n.d(a,{b:function(){return sendMessage},$:function(){return useSendMessage}});var l=n(41143),t=n.n(l),s=n(67294),i=n(22120),r=n(22578),o=n(12211),u=n(37650),d=n(36025),c=n(59519),g=n(46857),m=n(67275),p=n(90578),h=n(50530),b=n(47875),k=n(8611),y=n(81032),_=n(44311),f=n(89083),chat_getChatContentType=e=>{let{defaultBotObject:a}=(0,_.readInlineData)(n(38117),e);return a.hasMarkdownRendering?f.Z.text_markdown:f.Z.text_plain},F=n(64211),v=n(57708),S=n(27488),C=n(44912),K=n(64076),M=n(21774);let prepareUploadables=e=>{if(!e)return[null,null];let a=Array.from(e).reduce((e,a,n)=>({...e,["file".concat(n)]:a}),{});return[a,Array.from(Object.keys(a))]},w=n(53398),sendMessage=async e=>{let{environment:a,bot:l,chat:s,prompt:i,source:o,files:c=[],existingAttachments:m=[],setToast:k,setBotDetailsSidebar:_,onSuccessfulMessageSend:f=()=>{},clientNonce:S,t:C}=e;(0,p.Si)();let K=(0,g.h0)(),{id:I,chatId:L,isOptimistic:T,defaultBotObject:x,...A}=(0,r.readInlineData)(n(92750),s),D=(0,r.readInlineData)(n(88530),l),E=m.map(e=>(0,r.readInlineData)(n(39574),e)),B=S||(0,y.C)(),N={storeUpdater:e=>{T||(0,v.x6)(e,I),(0,u.A7)(e,D.id)}};(0,M.gc)(B,{prompt:i,files:c,source:o,optimisticUpdate:N}),(0,F.Gy)(B);let{optimisticHumanMessageId:R,optimisticHumanMessageEdgeId:P}=await onMessageSendChatUpdate({environment:a,chat:A,existingAttachments:E,prompt:i,files:c,source:o,clientNonce:B}),[V,G]=prepareUploadables(c),j=await K;a.applyUpdate(N),(0,r.commitMutation)(a,{mutation:w,variables:{chatId:T?null:L,shouldFetchChat:!!T,bot:x.nickname,query:i,messagePointsDisplayPrice:D.messagePointLimit.displayMessagePointPrice,source:o,clientNonce:B,attachments:G,existingMessageAttachmentsIds:E.map(e=>e.attachmentId),sdid:j},uploadables:V,updater:(e,a)=>{var n,l,t;if((null===(n=a.messageEdgeCreate)||void 0===n?void 0:n.status)===b.Z.success&&(null===(l=a.messageEdgeCreate)||void 0===l?void 0:l.message)){onSendSuccessUpdater(e,{bot:a.messageEdgeCreate.bot,chat:A,optimisticHumanMessageEdgeId:P,messageData:a.messageEdgeCreate.message.node});let n=a.messageEdgeCreate.chat,l=a.messageEdgeCreate.bot;T&&n&&l&&newChatUpdater(e,{bot:l,chat:n,message:a.messageEdgeCreate.message.node,optimisticChatId:I}),a.messageEdgeCreate.chat?((0,v.eM)(e,I),(0,v.x6)(e,a.messageEdgeCreate.chat.id)):(0,v.x6)(e,I),(0,u.A7)(e,D.id)}else(0,F.V8)(B),onSendFailureUpdater(e,{chatNodeId:I,optimisticHumanMessageEdgeId:P,errorMessage:null===(t=a.messageEdgeCreate)||void 0===t?void 0:t.statusMessage})},onCompleted:e=>{a.revertUpdate(N);let n=onSendMessageCompleted(e,k,_,R,B);n&&f(e)},onError:()=>{(0,F.V8)(B),(0,r.commitLocalUpdate)(a,e=>{onSendFailureUpdater(e,{chatNodeId:I,optimisticHumanMessageEdgeId:P,errorMessage:window.navigator.onLine?C("Message failed to send."):C("Unable to send this message. Check your internet connection.")})})}}),t()((0,h.h)(R),"Expected optimistic human message id to be a number"),(0,d.CE)(R,L)},onMessageSendChatUpdate=async e=>{let a,l,{environment:s,chat:i,prompt:o,files:u,existingAttachments:d,source:c,clientNonce:g}=e,{id:m,...p}=(0,r.readInlineData)(n(4690),i),b=d.map(e=>(0,r.readInlineData)(n(19984),e).id),k=await Promise.all(u.map(e=>(0,K.jH)(s,e))),y=chat_getChatContentType(p);return(0,r.commitLocalUpdate)(s,e=>{let n=e.get(m);t()(n,"Expected Chat record with id ".concat(m," to exist when sending a message"));let s=(0,K.Gx)(e,{prompt:o,attachmentIds:[...b,...k],source:c,clientNonce:g,contentType:y}),i=(0,C.n3)(e,n,s);a=i.getDataID(),l=s.getValue("messageId")}),t()((0,h.h)(l),"Expected optimistic human message id to be a number"),t()(a,"Expected optimistic human message edge id to exist"),{optimisticHumanMessageId:l,optimisticHumanMessageEdgeId:a}},onSendMessageCompleted=(e,a,n,l,s)=>{let i=e.messageEdgeCreate.status;if(i!==b.Z.success)return!1;let r=getErrorMessageFromFailedUrls(e.messageEdgeCreate.failedUrls);return r&&a({type:o.pC.error,content:r}),n(e.messageEdgeCreate.bot,!1),t()(e.messageEdgeCreate.message,"No message on a successful send message mutation"),(0,d.Ot)(l,e.messageEdgeCreate.message.node.messageId),(0,M.Mo)(s),!0},getErrorMessageFromFailedUrls=e=>{if(0===e.length)return null;let a=e[0].reason;if(1===e.length)switch(a){case"fetch_error":return"Failed to fetch ".concat(e[0].url," because of a problem crawling the URL.");case"over_budget":return"Failed to fetch ".concat(e[0].url," because it was too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e[0].url," because it was not a supported content type.");default:return"Failed to fetch ".concat(e[0].url,".")}switch(a){case"fetch_error":return"Failed to fetch ".concat(e.length," urls because of problems crawling them.");case"over_budget":return"Failed to fetch ".concat(e.length," urls because they were too large. Please keep crawled web pages to <100 MB total.");case"unsupported_content_type":return"Failed to fetch ".concat(e.length," urls because of unsupported content types.");default:return"Failed to fetch ".concat(e.length," urls.")}},onSendSuccessUpdater=(e,a)=>{let{bot:l,chat:s,optimisticHumanMessageEdgeId:i,messageData:o}=a,{id:u,...d}=(0,r.readInlineData)(n(97048),s),c=(0,r.readInlineData)(n(60706),l),g=e.get(u),m=e.get(i);t()(g,"Expected Chat record with id ".concat(u," to exist when sending a message"));let p=(0,C.kz)(e,g,m,o),h=(0,C.Ey)(g);if((null==h?void 0:h.getDataID())===(null==p?void 0:p.getDataID())){let a=chat_getChatContentType(d),n=(0,K.dS)(e,{contentType:a,bot:c}),l=n.getValue("messageId");l&&(0,F.OE)(l,{source:"sendMessage",botId:c.botId}),(0,C.n3)(e,g,n)}},newChatUpdater=(e,a)=>{let{bot:l,chat:s,message:i,optimisticChatId:o}=a,u=(0,r.readInlineData)(n(87065),s),{id:d}=(0,r.readInlineData)(n(13182),i),c=(0,r.readInlineData)(n(7741),l);(0,m.mK)(u.chatId,o);let g=e.get(u.id);t()(g,"Cannot find chat record with id ".concat(u.id)),e.getRoot().setLinkedRecord(g,"chatOfCode",{chatCode:u.chatCode});let p=(0,C.Ey)(g);if((null==p?void 0:p.getDataID())===d){let a=chat_getChatContentType(u),n=(0,K.dS)(e,{contentType:a,bot:c});(0,C.n3)(e,g,n)}},onSendFailureUpdater=(e,a)=>{var n;let{chatNodeId:l,optimisticHumanMessageEdgeId:s,errorMessage:i}=a,r=e.get(l),o=null===(n=e.get(s))||void 0===n?void 0:n.getLinkedRecord("node");t()(r,"Expected Chat record with id ".concat(l," to exist when sending a message")),t()(o,"Expected optimistic human message to exist after sending a message"),(0,S.f3)(o,k.Z.error),o.setValue(i,"errorMessage")},useSendMessage=e=>{let{source:a,bot:n,chat:l}=e,t=(0,r.useRelayEnvironment)(),u=(0,o.ZP)(),d=(0,c.X)(),{t:g}=(0,i.$G)(),m=(0,s.useCallback)(async e=>{let{prompt:s,files:i,existingAttachments:r,source:o,onSuccessfulMessageSend:c,clientNonce:m}=e;return await sendMessage({environment:t,bot:n,chat:l,prompt:s,files:i,existingAttachments:r,source:o||a,setToast:u,setBotDetailsSidebar:d,onSuccessfulMessageSend:e=>{null==c||c(e)},clientNonce:m,t:g})},[n,l,t,u,d,a,g]);return m}},42240:function(e,a,n){"use strict";n.d(a,{Y:function(){return useDragAndDrop}});var l=n(67294);let dragContainsNonFileData=e=>{var a;let n=(null===(a=e.dataTransfer)||void 0===a?void 0:a.types)||[];return n.some(e=>"Files"!==e)},useDragEventListener=(e,a,n)=>{(0,l.useEffect)(()=>{let l=e.current;return l&&n?(l.addEventListener(a,n),()=>{l.removeEventListener(a,n)}):()=>{}},[e,a,n])},onDropTargetDragOver=e=>{e.preventDefault()},useDragState=e=>{let[a,n]=(0,l.useState)(!1),t=(0,l.useRef)(0),s=(0,l.useCallback)(()=>{n(!1),t.current=0},[]),i=(0,l.useCallback)(e=>{e.preventDefault(),t.current++,dragContainsNonFileData(e)||n(!0)},[]),r=(0,l.useCallback)(e=>{e.preventDefault(),t.current--,t.current<=0&&n(!1)},[]);return useDragEventListener(e,"dragenter",i),useDragEventListener(e,"dragleave",r),useDragEventListener(e,"dragover",onDropTargetDragOver),{isDraggingOver:a,clearState:s}},useDragAndDrop=(e,a)=>{let n=(0,l.useRef)(document),{isDraggingOver:t,clearState:s}=useDragState(n),{isDraggingOver:i,clearState:r}=useDragState(e),o=(0,l.useCallback)(()=>{s(),r()},[s,r]),u=(0,l.useCallback)(e=>{e.preventDefault(),o(),dragContainsNonFileData(e)||a(e)},[o,a]);return useDragEventListener(n,"drop",o),useDragEventListener(e,"drop",u),{isDropTargetDraggingOver:i,isDocumentDraggingOver:t}}},67991:function(e,a,n){"use strict";n.d(a,{K:function(){return l},a:function(){return preloadFile}});let l=["image/jpeg","image/png"];function preloadFile(e){if(!FileReader||0!==e.size)return;let a=new FileReader;a.onload=()=>{},a.readAsBinaryString(e)}},74766:function(e,a){"use strict";var n,l;(l=n||(n={})).home_page_input="home_page_input",l.chat_history_input="chat_history_input",l.chat_settings_new_chat_button="chat_settings_new_chat_button",l.plus_new_chat_button="plus_new_chat_button",l.introduction_suggested_reply="introduction_suggested_reply",l.home_page_conversation_starter="home_page_conversation_starter",a.Z=n},87841:function(e){e.exports={dropTarget:"ChatDragDropTarget_dropTarget__1WrAL"}},70442:function(e){e.exports={button:"ChatMessageFileInputButton_button___6Emy",input:"ChatMessageFileInputButton_input__svNx4"}},47180:function(e){e.exports={"compact-only":"only screen and (max-width : 684px)",container:"ChatMessageInputAttachments_container__AAxGu",attachment:"ChatMessageInputAttachments_attachment__ZTrHT"}},38154:function(e){e.exports={"compact-only":"only screen and (max-width : 684px)",inputContainer:"ChatMessageInputContainer_inputContainer__s2AGa",botSelector:"ChatMessageInputContainer_botSelector__5QwRE",textArea:"ChatMessageInputContainer_textArea__fNi6E",sendButton:"ChatMessageInputContainer_sendButton__dBjTt",fileInput:"ChatMessageInputContainer_fileInput__9lLAY"}},68702:function(e){e.exports={noFreeMessageTooltip:"ChatMessageLimitTooltip_noFreeMessageTooltip__dMRGn",tooltipClickable:"ChatMessageLimitTooltip_tooltipClickable__gsAxK",tooltipNonClickable:"ChatMessageLimitTooltip_tooltipNonClickable__W6ZwL",tooltipMuted:"ChatMessageLimitTooltip_tooltipMuted__j1QBl",tooltipNotMuted:"ChatMessageLimitTooltip_tooltipNotMuted__S91Y8",chevronIcon:"ChatMessageLimitTooltip_chevronIcon__6MFcg"}},92002:function(e){e.exports={sendButton:"ChatMessageSendButton_sendButton__4ZyI4"}},3350:function(e){e.exports={button:"ChatMessageVoiceInputButton_button__NjXno",pulse:"ChatMessageVoiceInputButton_pulse__5F2SB",fadeInUpAndOut:"ChatMessageVoiceInputButton_fadeInUpAndOut__NP3s1"}},81952:function(e){e.exports={tooltip:"Tooltip_tooltip__1Q3kv",fadeInUpAndOut:"Tooltip_fadeInUpAndOut__BYIBO"}},25432:function(e){e.exports={dismissableContainer:"Dismissable_dismissableContainer__4Q5Jv",dismissButton:"Dismissable_dismissButton__faL3Y",icon:"Dismissable_icon__nU8Xb"}},71953:function(e){e.exports={growWrap:"GrowingTextArea_growWrap__im5W3",textArea:"GrowingTextArea_textArea__ZWQbP",hidden:"GrowingTextArea_hidden__xLW0K"}},15490:function(e){e.exports={banner:"WarningBanner_banner__otlmq",iconContainer:"WarningBanner_iconContainer__YW6xV"}}}]);